# pdf-image-extractor

このプロジェクトは、PythonとStreamlitを使用して、PDFファイルから画像を抽出し、ダウンロードできるWebアプリケーションです。PDFドキュメントに埋め込まれた画像を簡単に取得したい場合に便利です。

## 使用している主な技術

* **Python**: プログラミング言語
* **Streamlit**: Webアプリケーションフレームワーク
* **PyMuPDF (`fitz`)**: PDFファイルの解析と画像抽出
* **Pillow (`PIL`)**: 抽出された画像の読み込みと表示（プレビュー用）
* **io, os, zipfile, shutil**: ファイル操作、ディレクトリ管理、ZIPアーカイブ作成

## プロジェクトの概要

このアプリケーションは、ユーザーがPDFファイルをアップロードすると、そのPDFから埋め込まれた画像を自動的に抽出し、プレビュー表示します。抽出されたすべての画像は、一つのZIPファイルとしてダウンロードすることが可能です。

**主な機能:**

* **PDFファイルのアップロード**: 直感的なインターフェースでPDFファイルをアップロードできます。
* **高精度な画像抽出**: `PyMuPDF`ライブラリを利用して、PDF内の埋め込み画像を効率的に抽出します。
* **抽出画像のプレビュー**: 抽出された画像の一部をWebアプリケーション上で確認できます。
* **ZIP一括ダウンロード**: 抽出されたすべての画像をまとめてZIP形式でダウンロードできます。
* **一時ファイルの自動クリーンアップ**: アップロードされたPDFファイルや抽出された画像の一時ファイルは、セッション終了時やアプリのリロード時に自動的に削除されます（Streamlitの挙動に依存）。

## 必要な環境変数やコマンド一覧

### 環境変数

このアプリケーションでは、特に環境変数を設定する必要はありません。

### コマンド一覧

プロジェクトルートディレクトリで実行します。

* **アプリケーションの起動**:
    ```bash
    streamlit run streamlit_pdf_image_extractor.py
    ```



## 開発環境の構築方法

1.  **Pythonのインストール**:
    Python 3.8以上のバージョンが推奨されます。

2.  **仮想環境の作成とアクティベート**:
    ```bash
    python -m venv venv
    # Windows の場合
    .\venv\Scripts\activate
    # macOS/Linux の場合
    source venv/bin/activate
    ```

3.  **必要なライブラリのインストール**:
    ```bash
    pip install streamlit PyMuPDF Pillow
    ```
    * `PyMuPDF`は`fitz`という名前でインポートされます。
    * `Pillow`は`PIL`という名前でインポートされます。

4.  **アプリケーションの起動**:
    すべての準備が整ったら、以下のコマンドでアプリケーションを起動します。

    ```bash
    streamlit run streamlit_pdf_image_extractor.py
    ```
    ブラウザで`http://localhost:8501`が開かれ、アプリケーションが利用可能になります。

## トラブルシューティング

* **`streamlit run`コマンドが見つからない**:
    `streamlit`ライブラリが正しくインストールされていない可能性があります。仮想環境がアクティベートされていることを確認し、`pip install streamlit`を再度実行してみてください。

* **`ModuleNotFoundError: No module named 'fitz'`**:
    `PyMuPDF`が正しくインストールされていません。`pip install PyMuPDF`を再度実行してください。

* **ブラウザが開かない、またはエラーが出る**:
    `streamlit run`コマンドを実行した際にコンソールに表示されるURL（通常は`http://localhost:8501`）を、手動でブラウザのアドレスバーに入力してみてください。ポート8501が他のアプリケーションによって使用されている場合、Streamlitは自動的に別のポートで起動しますので、コンソールのメッセージを確認してください。

* **「画像の抽出中にエラーが発生しました」と表示される**:
    アップロードされたPDFファイルが破損している、またはPDFの構造が複雑で`PyMuPDF`が解析できない場合があります。別のPDFファイルで試してみてください。

* **画像が抽出されない**:
    PDF内に画像が埋め込まれていない可能性があります。テキスト情報のみのPDFからは画像は抽出できません。

* **「extracted_images.zip」をダウンロードしてもファイルが見つからない、または破損している**:
    稀に、一時ファイルがダウンロード前に削除されてしまうタイミングの問題が発生することがあります。通常はStreamlitがダウンロード処理を待ってからセッションを終了しますが、環境によっては発生しえます。その場合は、もう一度抽出・ダウンロードを試してみてください。

---

このツールは、PDFからの画像抽出を非常にシンプルかつ効率的に行えるように設計されています。ぜひ活用してみてください。
