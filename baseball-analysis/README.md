

# baseball-analysis

## 使用している主な技術

  * **Python**
  * **Streamlit**: Webアプリケーションフレームワーク
  * **Pandas**: データ操作・分析
  * **Plotly Express**: インタラクティブなグラフ描画
  * **Numpy**: 数値計算

## プロジェクトの概要

このアプリケーションは、日本のプロ野球（NPB）選手の成績データをインタラクティブに分析・可視化するためのWebアプリケーションです。

サンプルデータとして、**セントラル・リーグ6球団**から投打1名ずつ、**2021年〜2025年**の成績を対象としています。

### 主な機能

  * **投打成績の切替**: 打撃成績と投手成績を切り替えて表示できます。
  * **豊富なフィルタリング**: 年度、チーム、規定打席・投球回で選手データを絞り込めます。
  * **選手ランキング**: 様々な指標（打率、OPS、防御率など）で選手をランキング表示し、グラフで可視化します。
  * **相関分析**: 2つの指標をX軸とY軸に設定し、選手の相関関係を散布図で確認できます。
  * **チーム別比較**: チームごとの平均成績を棒グラフで比較し、チームの強みや弱みを分析できます。
  * **個人成績推移**: 特定の選手の年度ごとの成績推移を折れ線グラフで追跡できます。
  * **データダウンロード**: 表示しているデータをCSVファイルとしてダウンロードできます。

## 必要な環境変数やコマンド一覧

### 必要なファイル (`requirements.txt`)

以下の内容で`requirements.txt`ファイルを作成してください。

```txt
streamlit
pandas
plotly
numpy
```

### 環境変数

このアプリケーションを実行するために必要な環境変数はありません。

### コマンド一覧

1.  **ライブラリのインストール**

    ```bash
    pip install -r requirements.txt
    ```

2.  **アプリケーションの実行**

    ```bash
    streamlit run sample.py
    ```

## ディレクトリ構成

アプリケーションを実行するには、以下のディレクトリ構成でファイルを配置してください。

```
.
├── data/
│   ├── batting.csv
│   └── pitching.csv
├── sample.py
├── requirements.txt
└── README.md
```

## 開発環境の構築方法

1.  **プロジェクトファイルの配置**
    上記のディレクトリ構成に従って、`sample.py`と`data`フォルダ等を配置します。

2.  **Python仮想環境の構築（推奨）**

    ```bash
    # 仮想環境を作成
    python -m venv venv
    # 仮想環境を有効化 (Windowsの場合)
    venv\Scripts\activate
    # (Mac/Linuxの場合)
    # source venv/bin/activate
    ```

3.  **依存ライブラリのインストール**
    ターミナルで以下のコマンドを実行し、必要なライブラリをインストールします。

    ```bash
    pip install -r requirements.txt
    ```

4.  **アプリケーションの起動**
    以下のコマンドでアプリケーションを起動します。

    ```bash
    streamlit run sample.py
    ```

    ブラウザで `http://localhost:8501` にアクセスするとアプリケーションが表示されます。

## トラブルシューティング

  * **`FileNotFoundError` が表示される場合**
    `sample.py`と同じ階層に`data`フォルダがあり、その中に`batting.csv`と`pitching.csv`が正しく配置されているか確認してください。

  * **`KeyError` が表示される場合**
    CSVファイルの列名（ヘッダー行）と、プログラムが期待している列名が一致していません。例えば、プログラム側は `敗戦` を期待しているのに、CSVファイルが `敗北` になっている、などのケースが考えられます。CSVファイルヘッダーの単語や、前後に不要な空白がないかを確認してください。

  * **文字化けや`UnicodeDecodeError`が発生する場合**
    CSVファイルの文字コードが原因である可能性があります。本プログラムは`UTF-8`と`Shift_JIS(cp932)`に対応していますが、それでもエラーが出る場合は、お使いのCSVファイルをこれらの形式で保存し直してください。
